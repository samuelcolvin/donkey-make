#!/usr/bin/env donk
lint:
  run:
  - cargo fmt --version
  - cargo fmt --all -- --check
  - cargo clippy --version
  - cargo clippy -- -D warnings
  description: 'run both cargo fmt and clippy in "check" mode'

format:
- cargo fmt

test:
  run:
  - source env/bin/activate
  - python3 -m pytest tests/
  description: run tests
  ex: bash

all:
  - cargo fmt --all -- --check
  - cargo clippy -- -D warnings
  - set +x
  - source env/bin/activate
  - python3 -m pytest tests/

release:
  run:
  - rm -rf target/release/
  - export TRAVIS_COMMIT="$(git rev-parse HEAD)"
  - cargo build --release
  - cp target/release/donkey-make donk
  description: build a release version of the donkey-make binary "donk" and copy into thie directory
